<a class="brandbar-logo-link" routerLink="/" aria-label="Revenir à l’accueil (non authentifié)">
  <img class="brandbar-logo" src="assets/brand/sneakyDateReforged-Logo.svg" alt="SneakyDate" />
</a>

<main class="reg-layout">
  <!-- Colonne gauche : Titre + Carte formulaire -->
  <section class="reg-left">
    <header class="reg-head">
      <h1 class="reg-title">INSCRIPTION</h1>
      <a class="reg-login" routerLink="/auth/login">Déjà inscrit ? <span>CONNEXION</span></a>
    </header>

    <section class="reg-card">
      <!-- Formulaire réactif -->
      <form id="registerForm" class="reg-form" [formGroup]="form" (ngSubmit)="submit()">
        <div class="field inbox">
          <label class="label" for="email">Email</label>
          <input id="email" class="input" type="email" formControlName="email" placeholder="exemple@email.com" />
          <p class="hint error" *ngIf="form.get('email')?.touched && form.get('email')?.hasError('email')">
            Format invalide
          </p>
        </div>

        <div class="row row-steam">
          <div class="field inbox">
            <label class="label" for="steamId">Steam ID</label>
            <input id="steamId" class="input" type="text" formControlName="steamId" placeholder="767554922136481" />
          </div>
          <!-- Ouvre le popup -->
          <button type="button" class="btn-outline" (click)="openSteamHelp()">COMMENT OBTENIR MA STEAM ID ?</button>
        </div>

        <!-- Connexion Discord -->
        <button type="button" class="btn-discord" (click)="openDiscordInvite()"
          [class.is-valid]="form.get('discordConnected')?.value"
          [attr.aria-pressed]="form.get('discordConnected')?.value">
          <img class="chk-icon"
            [src]="form.get('discordConnected')?.value ? 'assets/icons/checkboxChecked.png' : 'assets/icons/checkboxEmpty.png'"
            alt="" width="16" height="16" loading="lazy" />
          <span class="btn-label">
            {{ form.get('discordConnected')?.value ? 'DISCORD CONNECTÉ' : 'CONNEXION DISCORD' }}
          </span>
        </button>

        <div class="row row-2">
          <div class="field inbox">
            <label class="label" for="password">Mot de passe</label>
            <input id="password" class="input" type="password" formControlName="password" placeholder="********" />
          </div>

          <div class="field inbox">
            <label class="label" for="confirmPassword">Répétez votre mot de passe</label>
            <input id="confirmPassword" class="input" type="password" formControlName="confirmPassword"
              placeholder="********" />
            <p class="hint error"
              *ngIf="form.get('confirmPassword')?.touched && form.get('confirmPassword')?.hasError('required')">
              Requis
            </p>
          </div>
        </div>

        <p *ngIf="error" class="auth-error">{{ error }}</p>
      </form>
    </section>

    <div class="reg-cta">
      <button class="btn-cta" type="submit" form="registerForm"
        [disabled]="loading || form.invalid || !form.get('discordConnected')?.value">
        {{ loading ? 'Création…' : 'INSCRIPTION' }}
      </button>
      <a class="policy" href="javascript:void(0)">Politiques de confidentialité</a>
    </div>
  </section>

  <!-- Colonne droite -->
  <aside class="reg-right">
    <div class="hero">
      <div class="conditions">
        <div class="cond-head">
          <img class="cond-icon" src="../../../assets/icons/membershipIcon.png" alt="">
          <span class="cond-title">CONDITIONS D’ADHESIONS :</span>
        </div>
        <ul class="cond-list">
          <li><img src="../../../assets/icons/validateIcon.png" alt=""> Avoir un compte Discord</li>
          <li><img src="../../../assets/icons/validateIcon.png" alt=""> Avoir un compte Steam</li>
        </ul>
      </div>
    </div>
  </aside>
</main>

<!-- ===== Modal Steam Help ===== -->
<div class="modal-backdrop" *ngIf="steamHelpOpen" (click)="closeSteamHelp()"></div>
<div class="modal" *ngIf="steamHelpOpen" role="dialog" aria-modal="true" aria-labelledby="steamHelpTitle"
  (click)="closeSteamHelp()">
  <div class="modal-dialog" (click)="$event.stopPropagation()">
    <header class="modal-header">
      <h2 id="steamHelpTitle">Où trouver votre Steam ID ?</h2>
      <button type="button" class="modal-close" (click)="closeSteamHelp()" aria-label="Fermer">×</button>
    </header>
    <div class="modal-body">
      <p>
        Ouvrez Steam → cliquez sur votre <strong>Profil</strong> → copiez l’URL (ex.
        <em>https://steamcommunity.com/id/…</em>).<br><br>
        Si c’est une URL personnalisée, faites clic-droit &ldquo;Copier l’identifiant&rdquo; ou utilisez
        <em>Afficher l’URL du profil</em> dans les paramètres.<br><br>Votre SteamID64 ressemble à
        <code>7656119XXXXXXXXXX</code>.
      </p>
    </div>
  </div>
</div>