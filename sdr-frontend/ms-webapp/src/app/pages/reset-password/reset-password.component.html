<a
  class="brandbar-logo-link"
  routerLink="/"
  aria-label="Revenir à l’accueil (non authentifié)"
>
  <img class="brandbar-logo" src="assets/brand/sneakyDateReforged-Logo.svg" alt="SneakyDate" />
</a>

<main class="reg-layout">
  <!-- Colonne gauche -->
  <section class="reg-left">
    <header class="reg-head">
      <h1 class="reg-title">RÉINITIALISATION DU MOT DE PASSE</h1>
    </header>

    <section class="reg-card">
      <!-- Formulaire si token présent -->
      <ng-container *ngIf="token; else invalidToken">
        <form id="resetForm" class="reg-form" [formGroup]="form" (ngSubmit)="submit()">
          <p class="reg-sub">
            Veuillez choisir votre nouveau mot de passe.<br />
            Pour des raisons de sécurité, il doit contenir au minimum <strong>12 caractères</strong>.
          </p>

          <div class="field inbox">
            <label class="label" for="newPassword">Mot de passe</label>
            <input
              id="newPassword"
              class="input"
              type="password"
              formControlName="newPassword"
              placeholder="********"
            />
            <p class="hint error" *ngIf="form.get('newPassword')?.touched && form.get('newPassword')?.hasError('required')">
              Requis
            </p>
            <p class="hint error" *ngIf="form.get('newPassword')?.touched && form.get('newPassword')?.hasError('minlength')">
              Minimum 12 caractères
            </p>
          </div>

          <div class="field inbox">
            <label class="label" for="confirmPassword">Confirmer le mot de passe</label>
            <input
              id="confirmPassword"
              class="input"
              type="password"
              formControlName="confirmPassword"
              placeholder="********"
            />
            <p class="hint error" *ngIf="form.get('confirmPassword')?.touched && form.get('confirmPassword')?.hasError('required')">
              Requis
            </p>
            <p class="hint error" *ngIf="form.touched && form.errors?.['passwordsMismatch']">
              Les mots de passe ne correspondent pas
            </p>
          </div>

          <p *ngIf="success" class="auth-success">{{ success }}</p>
          <p *ngIf="error" class="auth-error">{{ error }}</p>
        </form>
      </ng-container>

      <!-- Cas lien invalide -->
      <ng-template #invalidToken>
        <div class="reg-invalid">
          <p class="auth-error">Lien invalide ou expiré.</p>
          <p class="hint">Tu peux demander un nouveau lien depuis l’écran
            <a routerLink="/forgot-password">Mot de passe oublié</a>.
          </p>
        </div>
      </ng-template>
    </section>

    <!-- CTA alignés comme la maquette -->
    <div class="reg-cta reg-cta--split">
      <button type="button" class="btn-ghost" (click)="goBack()">RETOUR</button>
      <button
        *ngIf="token"
        class="btn-cta"
        type="submit"
        form="resetForm"
        [disabled]="loading || form.invalid"
      >
        {{ loading ? '...' : 'RÉINITIALISER' }}
      </button>
    </div>
  </section>

  <!-- Colonne droite (Hero Steam) -->
  <aside class="reg-right">
    <div class="hero hero--reset"></div>
  </aside>
</main>
