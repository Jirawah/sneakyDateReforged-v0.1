<div class="flex-center" style="min-height:calc(100vh - 32px); padding:16px;">
  <mat-card style="width:100%; max-width:520px;">
    <mat-card-header>
      <mat-card-title>Réinitialisation du mot de passe</mat-card-title>
      <mat-card-subtitle>Entre ton adresse email</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <p>Un email de réinitialisation te sera envoyé si l’adresse existe.</p>

      <form [formGroup]="form" (ngSubmit)="submit()">
        <mat-form-field appearance="outline" style="width:100%;">
          <mat-label>Email</mat-label>
          <input matInput type="email" formControlName="email" placeholder="exemple@email.com" />
          <mat-error *ngIf="form.get('email')?.hasError('required')">Email requis</mat-error>
          <mat-error *ngIf="form.get('email')?.hasError('email')">Format invalide</mat-error>
        </mat-form-field>

        <div class="flex-row space-between" style="margin-top:8px;">
          <a mat-stroked-button routerLink="/auth/login">Retour connexion</a>
          <button mat-flat-button color="primary" type="submit" [disabled]="form.invalid || loading">
            {{ loading ? 'Envoi…' : 'Envoyer' }}
          </button>
        </div>
      </form>

      <p *ngIf="success" style="color:green; margin-top:12px;">{{ success }}</p>
      <p *ngIf="error" style="color:red; margin-top:12px;">{{ error }}</p>
    </mat-card-content>
  </mat-card>
</div>


















:host {
  display: block;
  width: 100%;
  /* si ton PublicLayout utilise une grille, ça force le span pleine largeur */
  /* grid-column: 1 / -1; */
}

.flex-center {
  min-height: calc(100vh - 32px);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
}

mat-card {
  width: 100%;
  max-width: 520px;
}













import { Component, inject } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormBuilder, FormGroup, Validators, ReactiveFormsModule } from '@angular/forms';
import { Router, RouterLink } from '@angular/router';
import { PasswordResetService } from '../../core/services/password-reset.service';

// Angular Material
import { MatCardModule } from '@angular/material/card';
import { MatFormFieldModule } from '@angular/material/form-field';
import { MatInputModule } from '@angular/material/input';
import { MatButtonModule } from '@angular/material/button';
import { MatIconModule } from '@angular/material/icon';

@Component({
  selector: 'app-forgot-password',
  standalone: true,
  imports: [
    CommonModule,
    ReactiveFormsModule,
    RouterLink,
    MatCardModule,
    MatFormFieldModule,
    MatInputModule,
    MatButtonModule,
    MatIconModule,
  ],
  templateUrl: './forgot-password.component.html',
  styleUrls: ['./forgot-password.component.scss'],
})
export class ForgotPasswordComponent {
  private fb = inject(FormBuilder);
  private router = inject(Router);
  private resetService = inject(PasswordResetService);

  loading = false;
  error: string | null = null;
  success: string | null = null;

  form: FormGroup = this.fb.group({
    email: ['', [Validators.required, Validators.email]],
  });

  submit(): void {
    if (this.form.invalid) {
      this.form.markAllAsTouched();
      return;
    }
    this.loading = true;
    this.error = null;
    this.success = null;

    const email = this.form.get('email')!.value;
    this.resetService.requestReset(email).subscribe({
      next: (res) => {
        this.success = res?.message ?? 'Si cette adresse existe, un email de réinitialisation a été envoyé.';
        this.loading = false;
      },
      error: (err) => {
        console.error('[FORGOT-PASSWORD] error', err);
        this.error = err?.error?.message || 'Impossible d’envoyer la demande pour le moment.';
        this.loading = false;
      },
    });
  }

  goBack(): void {
    this.router.navigateByUrl('/auth/login');
  }
}
